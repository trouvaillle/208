---
layout: post
title:  "12. 데이터 시스템의 미래 - Section 1, 2"
date:   2024-12-19 00:00:00 +0900
categories: study books data-intensive-applications
author: 유석모
announced_on: 2024년 12월 19일
---

<img src="{{ "/assets/img/study/books/data-intensive-applications/chapter12/section1-2/intro.png" | relative_url }}" alt="image" width="480px"/>

마지막 장에서는 데이터 시스템이 미래에 어떻게 변화해야 하는지 설명한다.

상기하자면 이 책의 목적은 애플리케이션과 시스템을 신뢰할 수 있고 확장 가능하며 유지보수하기 쉽게 만드는 방법을 탐구하는 것이다.

- 신뢰성: 내결함성 알고리즘
- 확장성: 파티셔닝
- 유지보수성: 진화와 추상화 메커니즘

현재보다 나은, 견고하고 정확하며 발전 가능한 애플리케이션을 설계하는 방법을 발견하고자한다.

<br/>

## 데이터 통합 <small class="weak">Data Integration</small>

어떤 문제에 대한 몇 가지 해결책을 놓고 트레이드오프에 대해 설명하는 게 책의 주요 주제였다.

데이터를 사용하는 **모든** 상황에 적합한 소프트웨어가 있을 가능성은 낮다.

원하는 애플리케이션 기능을 제공하기 위해서는 반드시 여러 다른 소프트웨어를 함께 엮어 사용해야 한다.

<br/>


### 파생 데이터에 특화된 도구의 결합 <small class="weak">Combining Specialized Tools by Deriving Data</small>

예를 들어 OLTP 데이터베이스와 전문 검색 색인을 통합하는 요구는 일반적이다.

PostreSQL은 간단한 애플리케이션을 만들기에 충분하지만 복잡한 검색 용도로는 불완전하다.

검색 색인은 전문적인 정보 탐색에 유용하지만 일반적인 레코드 시스템으로는 부적합하다.

이와 같은 예와 같이 데이터를 다른 방식으로 표현하는 수가 늘어날수록 데이터 시스템을 통합하기 더욱 어렵다.

DB, 검색 색인, OLAP, 캐시, 머신러닝이나 분류, 랭킹, 추천 시스템으로 데이터를 전달하며 데이터 변화를 기반으로 한 알림을 보내기도 한다.

데이터를 다루는 범위는 어지러울 정도로 넓고 조직 전체 데이터플로를 고려할 필요가 있다.

<br/>

#### 데이터플로에 대한 추론 <small class="weak">Reasoning about dataflows</small>

같은 데이터 사본을 여러 저장소에 유지해야할 때 이벽과 출력을 분명히 할 필요가 있다.

데이터가 처음 기록되는 장소, 원본과 표현형의 파생 관계, 파생 데이터의 저장 장소와 형식 등에 대해 충분히 고려해야 한다.

예를 들면 변경 데이터 캡처(CDC)를 사용해 일관성을 유지할 수 있다.

검색 색인과 다른 데이터베이스를 사용하는 애플리케이션에서 두 곳으로 쓰기 요청을 보낸다면, <br/> 쓰기 충돌이 발생하기 쉽다. 쓰기의 순서를 결정하는 책임을 맡은 곳이 없기 때문이다. <br/>
이는 영구적인 불일치로 이어질 수 있다.

모든 쓰기의 순서를 결정하는 단일 시스템으로 모든 입력을 넣으면 쓰기를 같은 순서로 처리해 파생 데이터를 생성하기 쉬워진다.

이벤트 로그 기반으로 파생 데이터 시스템을 갱신하면 결정적이고 멱등성을 지녀 결함에서 복구하기가 상당히 쉬워진다.

<br/>

#### 파생 데이터 대 분산 트랜잭션 <small class="weak">Derived data versus distributed transactions</small>

서로 다른 데이터 시스템 간 일관성을 유지하는 고전적인 방법은 분산 트랜잭션이다.

파생 데이터와 분산 트랜잭션은 다른 방식으로 유사한 목표를 달성한다.

| 목표 | 분산 트랜젝션 | 파생 데이터(ex. CDC, 이벤트 소싱) |
| -- | -- | -- |
| 순서 결정 | 상호 배타적인 잠금 사용 | 로그 사용 |
| 정확히 한 번 보장 | 원자적 커밋 | 결정적 재시도와 멱등성 기반 |

분산 트랜잭션은 대개 선형성을 지원하지만<br/>
파생 데이터 시스템은 비동기로 갱신되어 동시간 갱신 보장을 하지 않는다.

분산 트랜잭션 프로토콜 중 XA는 결함 대응에 취약하고 성능면에서 나빠서 유용성이 제한적이다.

다른 대체제가 없는 상황에서 **로그 기반 파생 데이터**가 이종 데이터 시스템을 통합하는 가장 유망한 접근법이다.


<br/>

#### 전체 순서화의 제약 <small class="weak">The limits of total ordering</small>

작은 시스템에서 이벤트 로그의 전체 순서를 보장하는 것은 가능하나,<br/>
대규모 또는 큰 작업부하에서는 전체 순서화에 한계가 있다.

- 전체 순서를 위해 대부분 **단일 리더**가 필요하다.<br/>
    처리량이 커지면 **파티셔닝**을 해야하고, 파티션 간의 이벤트 순서는 애매하다.
- **지역적으로 분산된** 데이터 센터들에 서버가 걸쳐있다면 여러 독립된 리더를 지닌다.<br/>
    데이터센터 간의 이벤트 순서는 정해지지 않았다.
- **마이크로서비스** 배포 시 서로 다른 서비스에서 발생한 이벤트엔 정해진 순서가 없다.
- **클라이언트 상태를 유지**하는 경우 서버와 서로 다른 이벤트 순서를 지닐 수 있다.

이러한 전체 순서화는 **전체 순서 브로드캐스트**가 공식 용어이고 이는 합의와 동등하다.

<br/>

#### 인과성 획득을 위한 이벤트 순서화 <small class="weak">Ordering events to capture causality</small>
<br/>


### 일괄 처리와 스트림 처리 <small class="weak">Batch and Stream Processing</small>

<br/>

## 데이터베이스 언번들링 <small class="weak">Unbundling Databases</small>

<br/>

### 데이터 저장소 기술 구성하기 <small class="weak">Composing Data Storage Technologies</small>

<br/>

### 데이터플로 주변 애플리케이션 설계 <small class="weak">Designing Applications Around Dataflow</small>

<br/>



### 파생 상태 관찰하기 <small class="weak">Observing Derived State</small>

<br/>